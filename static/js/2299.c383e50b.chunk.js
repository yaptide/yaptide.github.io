"use strict";(self.webpackChunkthreejs_editor_react=self.webpackChunkthreejs_editor_react||[]).push([[2299],{2299:(e,t,r)=>{r.r(t),r.d(t,{TWebPaintingPainter:()=>i});var n=r(4435),a=r(6950);class i extends a.JW{updateObject(e){return!!this.matchObjectType(e)&&(this.assignObject(e),!0)}async redraw(){const e=this.getObject(),t=this.getAxisToSvgFunc();if(!e?.fOper||!t)return;let r,a,i,s=0,f={},c=null,l="none",o="";const h=e.fOper.split(";"),u=e=>{if(e!==l&&(c&&(c.attr("d",o),o="",c=null,l="none"),e))switch(l=e,c=this.draw_g.append("svg:path"),e){case"f":c.call(this.fillatt.func);break;case"l":c.call(this.lineatt.func).style("fill","none");break;case"m":c.call(this.markeratt.func)}},x=(e,t)=>{let r=0;const n={_typename:"any"};for(let a=0;a<t.length;++a){const i=e.indexOf(":",r+1);n[t[a]]=parseInt(e.slice(r+1,i>r?i:void 0)),r=i}return n},d=c=>{for(;++c<h.length;)switch(r=h[c][0],r){case"z":this.createAttLine({attr:x(h[c],["fLineColor","fLineStyle","fLineWidth"]),force:!0}),u();continue;case"y":this.createAttFill({attr:x(h[c],["fFillColor","fFillStyle"]),force:!0}),u();continue;case"x":this.createAttMarker({attr:x(h[c],["fMarkerColor","fMarkerStyle","fMarkerSize"]),force:!0}),u();continue;case"o":f=x(h[c],["fTextColor","fTextFont","fTextSize","fTextAlign","fTextAngle"]),f.fTextSize<0&&(f.fTextSize*=-.001),u();continue;case"r":case"b":{u("b"===r?"f":"l");const n=t.x(e.fBuf[s++]),a=t.y(e.fBuf[s++]),i=t.x(e.fBuf[s++]),f=t.y(e.fBuf[s++]);o+=`M${n},${a}h${i-n}v${f-a}h${n-i}z`;continue}case"l":case"f":for(u(r),a=parseInt(h[c].slice(1)),i=0;i<a;++i)o+=`${i>0?"L":"M"}${t.x(e.fBuf[s++])},${t.y(e.fBuf[s++])}`;"f"===r&&(o+="Z");continue;case"m":for(u(r),a=parseInt(h[c].slice(1)),this.markeratt.resetPos(),i=0;i<a;++i)o+=this.markeratt.create(t.x(e.fBuf[s++]),t.y(e.fBuf[s++]));continue;case"h":case"t":if(f.fTextSize){u();const a=f.fTextSize>1?f.fTextSize:this.getPadPainter().getPadHeight()*f.fTextSize,l=this.draw_g.append("svg:g");let o=f.fTextAngle,x=h[c].slice(1);if(o>=360&&(o-=360*Math.floor(o/360)),this.startTextDrawing(f.fTextFont,a,l),"h"===r){let e="";for(i=0;i<x.length;i+=2)e+=String.fromCharCode(parseInt(x.slice(i,i+2),16));x=e}return this.drawText({align:f.fTextAlign,x:t.x(e.fBuf[s++]),y:t.y(e.fBuf[s++]),rotate:-o,text:x,color:(0,n.oU)(f.fTextColor),latex:0,draw_g:l}),this.finishTextDrawing(l).then((()=>d(c)))}continue;default:console.log(`unsupported operation ${r}`)}return Promise.resolve(!0)};return this.createG(),d(-1).then((()=>(u(),this)))}static async draw(e,t){const r=new i(e,t);return r.addToPadPrimitives(),r.redraw()}}}}]);
//# sourceMappingURL=2299.c383e50b.chunk.js.map