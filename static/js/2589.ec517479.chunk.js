"use strict";(self.webpackChunkthreejs_editor_react=self.webpackChunkthreejs_editor_react||[]).push([[2589,4763],{4763:(t,i,e)=>{e.r(i),e.d(i,{TLinePainter:()=>h});var a=e(9490),s=e(6950),r=e(4861),n=e(9726),o=e(3558);const d=(0,a.BIT)(14);class h extends s.JW{moveStart(t,i){const e=Math.sqrt((this.x1-this.x2)**2+(this.y1-this.y2)**2),a=Math.sqrt((t-this.x1)**2+(i-this.y1)**2)/e,s=Math.sqrt((t-this.x2)**2+(i-this.y2)**2)/e;this.side=a>.9?1:s>.9?-1:0}moveDrag(t,i){1!==this.side&&(this.x1+=t,this.y1+=i),-1!==this.side&&(this.x2+=t,this.y2+=i),this.draw_g.select("path").attr("d",this.createPath())}moveEnd(t){if(t)return;const i=this.getObject();let e="";i.fX1=this.svgToAxis("x",this.x1,this.isndc),i.fX2=this.svgToAxis("x",this.x2,this.isndc),i.fY1=this.svgToAxis("y",this.y1,this.isndc),i.fY2=this.svgToAxis("y",this.y2,this.isndc),1!==this.side&&(e+=`SetX1(${i.fX1});;SetY1(${i.fY1});;`),-1!==this.side&&(e+=`SetX2(${i.fX2});;SetY2(${i.fY2});;`),this.submitCanvExec(e+"Notify();;")}prepareDraw(){const t=this.getObject();this.isndc=t.TestBit(d);const i=this.getAxisToSvgFunc(this.isndc,!0,!0);this.x1=i.x(t.fX1),this.y1=i.y(t.fY1),this.x2=i.x(t.fX2),this.y2=i.y(t.fY2),this.createAttLine({attr:t})}createPath(){const t=Math.round(this.x1),i=Math.round(this.x2),e=Math.round(this.y1),a=Math.round(this.y2);return`M${t},${e}`+(t===i?`V${a}`:e===a?`H${i}`:`L${i},${a}`)}addExtras(){}redraw(){this.createG(),this.prepareDraw();const t=this.draw_g.append("svg:path").attr("d",this.createPath()).call(this.lineatt.func);return this.getObject()?.$do_not_draw?t.remove():(this.addExtras(t),(0,n.X2)(this),(0,o.wh)(this,o.Ew)),this}static async draw(t,i,e){const a=new h(t,i,e);return(0,r.ensureTCanvas)(a,!1).then((()=>a.redraw()))}}},2589:(t,i,e)=>{e.r(i),e.d(i,{TRatioPlotPainter:()=>o});var a=e(9490),s=e(6950),r=e(4861),n=e(4763);class o extends s.JW{setGridsRange(t,i,e,s,r){const n=this.getObject();if(t===i){const e=this.getPadPainter()?.findPainterFor(n.fLowerPad,"lower_pad",a.clTPad)?.getFramePainter()?.x_handle;if(!e)return;0===t?(t=e.full_min,i=e.full_max):(t=e.scale_min,i=e.scale_max)}n.fGridlines.forEach((e=>{e.fX1=t,e.fX2=i}));const o=Math.min(n.fGridlines.length,n.fGridlinePositions.length);for(let a=0;a<o;++a){const t=n.fGridlinePositions[a],i=n.fGridlines[a];"ignorey"!==e&&(i.$do_not_draw=e!==s&&(t<e||t>s),i.fY1=i.fY2=t),r?.findPainterFor(i)?.redraw()}}configureInteractive(){const t=this.getObject(),i=this.getPadPainter(),e=i.findPainterFor(t.fUpperPad,"upper_pad",a.clTPad),s=e?.getFramePainter(),r=i.findPainterFor(t.fLowerPad,"lower_pad",a.clTPad),n=r?.getFramePainter();e&&r&&(r.forEachPainterInPad((t=>{(0,a.isFunc)(t?.testEditable)&&t.testEditable(!1)})),this.setGridsRange(n.scale_xmin,n.scale_xmax,n.scale_ymin,n.scale_ymax,r),e._ratio_interactive&&r._ratio_interactive||(e._ratio_interactive=!0,r._ratio_interactive=!0,s.o_zoom=s.zoom,s._ratio_low_fp=n,s._ratio_painter=this,s.zoom=function(t,i,e,a,r,n){return this.o_zoom(t,i,e,a,r,n).then((t=>(this._ratio_painter.setGridsRange(s.scale_xmin,s.scale_xmax,"ignory"),this._ratio_low_fp.o_zoom(s.scale_xmin,s.scale_xmax).then((()=>t)))))},s.o_sizeChanged=s.sizeChanged,s.sizeChanged=function(){this.o_sizeChanged(),this._ratio_low_fp.fX1NDC=this.fX1NDC,this._ratio_low_fp.fX2NDC=this.fX2NDC,this._ratio_low_fp.o_sizeChanged()},n.o_zoom=n.zoom,n._ratio_up_fp=s,n._ratio_painter=this,n.zoom=function(t,i,e,a,r,n){return t===i?(t=s.xmin,i=s.xmax):(t<s.xmin&&(t=s.xmin),i>s.xmax&&(i=s.xmax)),this._ratio_painter.setGridsRange(t,i,e,a),this._ratio_up_fp.o_zoom(t,i).then((()=>this.o_zoom(t,i,e,a,r,n)))},n.o_sizeChanged=n.sizeChanged,n.sizeChanged=function(){this.o_sizeChanged(),this._ratio_up_fp.fX1NDC=this.fX1NDC,this._ratio_up_fp.fX2NDC=this.fX2NDC,this._ratio_up_fp.o_sizeChanged()}))}async redrawOld(){const t=this.getObject(),i=this.getPadPainter(),e=i.findPainterFor(t.fTopPad,"top_pad",a.clTPad),s=i.getRootPad(),r=0===s.fFrameFillStyle?1:0,o=s.fTickx||r,d=s.fTicky||r;e?.disablePadDrawing();const h=i.findPainterFor(t.fUpperPad,"upper_pad",a.clTPad),f=h?.getMainPainter(),c=h?.getFramePainter(),_=i.findPainterFor(t.fLowerPad,"lower_pad",a.clTPad),l=_?.getMainPainter(),P=_?.getFramePainter();let p=Promise.resolve(!0);if(h&&f&&c&&P&&!h._ratio_configured){h._ratio_configured=!0,f.options.Axis=0;const t=f.getHisto();t.fYaxis.$use_top_pad=!0,t.fXaxis.fLabelSize=0,t.fXaxis.fTitle="",h.getRootPad().fTickx=o,h.getRootPad().fTicky=d,p=h.redrawPad()}return p.then((()=>{if(!_||!l||!P||!c||_._ratio_configured)return this;_._ratio_configured=!0,l.options.Axis=0;const i=l.getHisto();i.fXaxis.fTitle="x",i.fXaxis.$use_top_pad=!0,i.fYaxis.$use_top_pad=!0,_.getRootPad().fTickx=o,_.getRootPad().fTicky=d;const e=[];let s;return t.fGridlinePositions.length>0&&t.fGridlines.length<t.fGridlinePositions.length&&t.fGridlinePositions.forEach((i=>{let r=!1;if(t.fGridlines.forEach((t=>{t.fY1===t.fY2&&Math.abs(t.fY1-i)<1e-6&&(r=!0)})),!r){const r=(0,a.create)(a.clTLine);r.fX1=c.scale_xmin,r.fX2=c.scale_xmax,r.fY1=r.fY2=i,r.fLineStyle=2,t.fGridlines.push(r),void 0===s&&(s=this.selectCurrentPad(t.fLowerPad.fName)),e.push(n.TLinePainter.draw(this.getDom(),r))}})),Promise.all(e).then((()=>(void 0!==s&&this.selectCurrentPad(s),P.zoom(c.scale_xmin,c.scale_xmax))))}))}async redraw(){const t=this.getObject(),i=this.getPadPainter();if(void 0===this.$oldratio&&(this.$oldratio=!!i.findPainterFor(t.fTopPad,"top_pad",a.clTPad)),i.$userInteractive=()=>this.configureInteractive(),this.$oldratio)return this.redrawOld();const e=i.getRootPad(),s=0===e.fFrameFillStyle?1:0,r=e.fTickx||s,n=e.fTicky||s;return t.fTopPad.$disable_drawing=!0,t.fUpperPad.$ratio_pad="up",t.fUpperPad.fTickx=r,t.fUpperPad.fTicky=n,t.fLowerPad.$ratio_pad="low",t.fLowerPad.fTickx=r,t.fLowerPad.fTicky=n,this}static async draw(t,i,e){const a=new o(t,i,e);return(0,r.ensureTCanvas)(a,!1).then((()=>a.redraw()))}}}}]);
//# sourceMappingURL=2589.ec517479.chunk.js.map