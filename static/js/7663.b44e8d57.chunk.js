"use strict";(self.webpackChunkthreejs_editor_react=self.webpackChunkthreejs_editor_react||[]).push([[7663],{7663:(t,i,e)=>{e.d(i,{G:()=>a});var s=e(9490),n=e(6950),o=e(7243);function r(t){t._typename===`${s.nsREX}RAxisEquidistant`||t._typename===`${s.nsREX}RAxisLabels`?(0===t.fInvBinWidth&&(t.$dummy=!0,t.fInvBinWidth=1,t.fNBinsNoOver=0,t.fLow=0),t.min=t.fLow,t.max=t.fLow+t.fNBinsNoOver/t.fInvBinWidth,t.GetNumBins=function(){return this.fNBinsNoOver},t.GetBinCoord=function(t){return this.fLow+t/this.fInvBinWidth},t.FindBin=function(t,i){return Math.floor((t-this.fLow)*this.fInvBinWidth+i)}):t._typename===`${s.nsREX}RAxisIrregular`&&(t.min=t.fBinBorders[0],t.max=t.fBinBorders[t.fBinBorders.length-1],t.GetNumBins=function(){return this.fBinBorders.length},t.GetBinCoord=function(t){const i=Math.round(t);if(i<=0)return this.fBinBorders[0];if(i>=this.fBinBorders.length)return this.fBinBorders[this.fBinBorders.length-1];if(i===t)return this.fBinBorders[i];const e=t<i?i-1:i+1;return this.fBinBorders[i]*Math.abs(t-e)+this.fBinBorders[e]*Math.abs(t-i)},t.FindBin=function(t,i){for(let e=1;e<this.fBinBorders.length;++e)if(t<this.fBinBorders[e])return Math.floor(e-1+i);return this.fBinBorders.length-1}),t.GetBinCenter=function(t){return this.GetBinCoord(t-.5)},t.GetBinLowEdge=function(t){return this.GetBinCoord(t-1)}}function h(t){return t?.fHistImpl?.fIO||null}class a extends o.D{constructor(t,i){super(t,i),this.csstype="hist",this.draw_content=!0,this.nbinsx=0,this.nbinsy=0,this.accept_drops=!0,this.mode3d=!1,this.getHisto(!0)}isDisplayItem(){return this.getObject()?.fAxes}getHisto(t){const i=this.getObject();let e=h(i);return!e||e.getBinContent&&!t?!e&&i?.fAxes&&(e=i,e.getBinContent&&!t||(3===e.fAxes.length?(r(e.fAxes[0]),r(e.fAxes[1]),r(e.fAxes[2]),e.nx=e.fIndicies[1]-e.fIndicies[0],e.dx=e.fIndicies[0]+1,e.stepx=e.fIndicies[2],e.ny=e.fIndicies[4]-e.fIndicies[3],e.dy=e.fIndicies[3]+1,e.stepy=e.fIndicies[5],e.nz=e.fIndicies[7]-e.fIndicies[6],e.dz=e.fIndicies[6]+1,e.stepz=e.fIndicies[8],e.getBin=function(t,i,e){return t-1+this.fAxes[0].GetNumBins()*(i-1)+this.fAxes[0].GetNumBins()*this.fAxes[1].GetNumBins()*(e-1)},e.stepx>1||e.stepy>1||e.stepz>1?e.getBin0=function(t,i,e){return Math.floor((t-this.dx)/this.stepx)+this.nx/this.stepx*Math.floor((i-this.dy)/this.stepy)+this.nx/this.stepx*this.ny/this.stepy*Math.floor((e-this.dz)/this.stepz)}:e.getBin0=function(t,i,e){return t-this.dx+this.nx*(i-this.dy)+this.nx*this.ny*(e-this.dz)},e.getBinContent=function(t,i,e){return this.fBinContent[this.getBin0(t,i,e)]},e.getBinError=function(t,i,e){return Math.sqrt(Math.abs(this.getBinContent(t,i,e)))}):2===e.fAxes.length?(r(e.fAxes[0]),r(e.fAxes[1]),e.nx=e.fIndicies[1]-e.fIndicies[0],e.dx=e.fIndicies[0]+1,e.stepx=e.fIndicies[2],e.ny=e.fIndicies[4]-e.fIndicies[3],e.dy=e.fIndicies[3]+1,e.stepy=e.fIndicies[5],e.getBin=function(t,i){return t-1+this.fAxes[0].GetNumBins()*(i-1)},e.stepx>1||e.stepy>1?e.getBin0=function(t,i){return Math.floor((t-this.dx)/this.stepx)+this.nx/this.stepx*Math.floor((i-this.dy)/this.stepy)}:e.getBin0=function(t,i){return t-this.dx+this.nx*(i-this.dy)},e.getBinContent=function(t,i){return this.fBinContent[this.getBin0(t,i)]},e.getBinError=function(t,i){return Math.sqrt(Math.abs(this.getBinContent(t,i)))}):(r(e.fAxes[0]),e.nx=e.fIndicies[1]-e.fIndicies[0],e.dx=e.fIndicies[0]+1,e.stepx=e.fIndicies[2],e.getBin=function(t){return t-1},e.stepx>1?e.getBin0=function(t){return Math.floor((t-this.dx)/this.stepx)}:e.getBin0=function(t){return t-this.dx},e.getBinContent=function(t){return this.fBinContent[this.getBin0(t)]},e.getBinError=function(t){return Math.sqrt(Math.abs(this.getBinContent(t)))}))):e.fAxes._2?(r(e.fAxes._0),r(e.fAxes._1),r(e.fAxes._2),e.getBin=function(t,i,e){return t-1+this.fAxes._0.GetNumBins()*(i-1)+this.fAxes._0.GetNumBins()*this.fAxes._1.GetNumBins()*(e-1)},e.getBinContent=function(t,i,e){return this.fStatistics.fBinContent[this.getBin(t,i,e)]},e.getBinError=function(t,i,e){const s=this.getBin(t,i,e);return this.fStatistics.fSumWeightsSquared?Math.sqrt(this.fStatistics.fSumWeightsSquared[s]):Math.sqrt(Math.abs(this.fStatistics.fBinContent[s]))}):e.fAxes._1?(r(e.fAxes._0),r(e.fAxes._1),e.getBin=function(t,i){return t-1+this.fAxes._0.GetNumBins()*(i-1)},e.getBinContent=function(t,i){return this.fStatistics.fBinContent[this.getBin(t,i)]},e.getBinError=function(t,i){const e=this.getBin(t,i);return this.fStatistics.fSumWeightsSquared?Math.sqrt(this.fStatistics.fSumWeightsSquared[e]):Math.sqrt(Math.abs(this.fStatistics.fBinContent[e]))}):(r(e.fAxes._0),e.getBin=function(t){return t-1},e.getBinContent=function(t){return this.fStatistics.fBinContent[t-1]},e.getBinError=function(t){return this.fStatistics.fSumWeightsSquared?Math.sqrt(this.fStatistics.fSumWeightsSquared[t-1]):Math.sqrt(Math.abs(this.fStatistics.fBinContent[t-1]))}),e}decodeOptions(){this.options||(this.options={Hist:1,System:1})}copyOptionsFrom(t){if(t===this)return;const i=this.options,e=t.options;i.Mode3D=e.Mode3D}copyOptionsToOthers(){this.forEachPainter((t=>{t!==this&&(0,s.isFunc)(t.copyOptionsFrom)&&t.copyOptionsFrom(this)}),"objects")}clear3DScene(){const t=this.getFramePainter();(0,s.isFunc)(t?.create3DScene)&&t.create3DScene(-1),this.mode3d=!1}cleanup(){this.clear3DScene(),delete this.options,super.cleanup()}getDimension(){return 1}scanContent(){}async drawFrameAxes(){const t=this.getFramePainter();return!!t&&(!this.draw_content||(this.isMainPainter()?(t.cleanupAxes(),t.xmin=t.xmax=0,t.ymin=t.ymax=0,t.zmin=t.zmax=0,t.setAxesRanges(this.getAxis("x"),this.xmin,this.xmax,this.getAxis("y"),this.ymin,this.ymax,this.getAxis("z"),this.zmin,this.zmax),t.drawAxes()):!this.options.second_x&&!this.options.second_y||(t.setAxes2Ranges(this.options.second_x,this.getAxis("x"),this.xmin,this.xmax,this.options.second_y,this.getAxis("y"),this.ymin,this.ymax),t.drawAxes2(this.options.second_x,this.options.second_y))))}createHistDrawAttributes(){this.createv7AttFill(),this.createv7AttLine()}updateDisplayItem(t,i){return!(!t||!i)&&(t.fAxes=i.fAxes,t.fIndicies=i.fIndicies,t.fBinContent=i.fBinContent,t.fContMin=i.fContMin,t.fContMinPos=i.fContMinPos,t.fContMax=i.fContMax,this.getHisto(!0),!0)}updateObject(t){const i=this.getObject();if(t!==i){if(!this.matchObjectType(t))return!1;if(this.isDisplayItem())this.updateDisplayItem(i,t);else{const e=h(i),s=h(t);if(!e||!s)return!1;e.fStatistics=s.fStatistics,i.fTitle=t.fTitle}}return this.scanContent(),this.histogram_updated=!0,!0}getAxis(t){const i=this.getHisto(),e=this.getObject();let s;if(e?.fAxes)switch(t){case"x":default:s=e.fAxes[0];break;case"y":s=e.fAxes[1];break;case"z":s=e.fAxes[2]}else if(i?.fAxes)switch(t){case"x":default:s=i.fAxes._0;break;case"y":s=i.fAxes._1;break;case"z":s=i.fAxes._2}return s&&!s.GetBinCoord&&r(s),s}getAxisBinTip(t,i,e){const s=this.getFramePainter(),o=s[`${t}_handle`],r=this.getAxis(t),h=r.GetBinCoord(i);if(o.kind===n.ei)return s.axisAsText(t,h);const a=r.GetBinCoord(i+(e||1));return o.kind===n.Yu?s.axisAsText(t,(h+a)/2):`[${s.axisAsText(t,h)}, ${s.axisAsText(t,a)})`}extractAxesProperties(t){if(!this.getHisto())return;this.nbinsx=this.nbinsy=this.nbinsz=0;let i=this.getAxis("x");this.nbinsx=i.GetNumBins(),this.xmin=i.min,this.xmax=i.max,t<2||(i=this.getAxis("y"),this.nbinsy=i.GetNumBins(),this.ymin=i.min,this.ymax=i.max,t<3||(i=this.getAxis("z"),this.nbinsz=i.GetNumBins(),this.zmin=i.min,this.zmax=i.max))}addInteractivity(){const t=this.isMainPainter(),i=this.options.second_x||this.options.second_y,e=t||i?this.getFramePainter():null;return e?.addInteractivity(!t&&i)??!0}processItemReply(t,i){if(!this.isDisplayItem())return console.error("Get item when display normal histogram");i.reqid===this.current_item_reqid&&(null!==t&&this.updateDisplayItem(this.getObject(),t.item),i.resolveFunc(!0))}async drawingBins(t){let i=!1;if(t&&(0,s.isStr)(t)&&0===t.indexOf("zoom")&&(t.indexOf("0")>0&&(i=!0),this.getDimension()>1&&t.indexOf("1")>0&&(i=!0),this.getDimension()>2&&t.indexOf("2")>0&&(i=!0)),this.isDisplayItem()&&i&&this.v7NormalMode()){if(this.prepareDraw({only_indexes:!0}).incomplete)return new Promise((t=>{const i=this.v7SubmitRequest("",{_typename:`${s.nsREX}RHistDrawableBase::RRequest`},this.processItemReply.bind(this));i?(this.current_item_reqid=i.reqid,i.resolveFunc=t,setTimeout(this.processItemReply.bind(this,null,i),1e3)):t(!0)}))}return!0}toggleStat(){}getSelectIndex(t,i,e){const s=this.getAxis(t),n=this["nbins"+t]||0;let o=0;this.options.second_x&&"x"===t&&(t="x2"),this.options.second_y&&"y"===t&&(t="y2");const r=this.getFramePainter(),h=r?r[`zoom_${t}min`]:0,a=r?r[`zoom_${t}max`]:0;return h!==a&&s?(o="left"===i?s.FindBin(h,e||0):s.FindBin(a,(e||0)+.5),o<0?o=0:o>n&&(o=n)):o="left"===i?0:n,o}autoZoom(){}clickButton(t){const i=this.getFramePainter();if(!i)return!1;switch(t){case"ToggleZoom":if(this.zoom_xmin!==this.zoom_xmax||this.zoom_ymin!==this.zoom_ymax||this.zoom_zmin!==this.zoom_zmax){const t=this.unzoom();return i.zoomChangedInteractive("reset"),t}if(this.draw_content)return this.autoZoom();break;case"ToggleLogX":return i.toggleAxisLog("x");case"ToggleLogY":return i.toggleAxisLog("y");case"ToggleLogZ":return i.toggleAxisLog("z");case"ToggleStatBox":return(0,s.getPromise)(this.toggleStat())}return!1}fillToolbar(t){const i=this.getPadPainter();i&&(i.addPadButton("auto_zoom","Toggle between unzoom and autozoom-in","ToggleZoom","Ctrl *"),i.addPadButton("arrow_right","Toggle log x","ToggleLogX","PageDown"),i.addPadButton("arrow_up","Toggle log y","ToggleLogY","PageUp"),this.getDimension()>1&&i.addPadButton("arrow_diag","Toggle log z","ToggleLogZ"),this.draw_content&&i.addPadButton("statbox","Toggle stat box","ToggleStatBox"),t||i.showPadButtons())}get3DToolTip(t){const i=this.getHisto(),e={bin:t,name:i.fName||"histo",title:i.fTitle};switch(this.getDimension()){case 1:e.ix=t+1,e.iy=1,e.value=i.getBinContent(e.ix),e.error=i.getBinError(e.ix),e.lines=this.getBinTooltips(t-1);break;case 2:e.ix=t%this.nbinsx+1,e.iy=(t-(e.ix-1))/this.nbinsx+1,e.value=i.getBinContent(e.ix,e.iy),e.error=i.getBinError(e.ix,e.iy),e.lines=this.getBinTooltips(e.ix-1,e.iy-1);break;case 3:e.ix=t%this.nbinsx+1,e.iy=(t-(e.ix-1))/this.nbinsx%this.nbinsy+1,e.iz=(t-(e.ix-1)-(e.iy-1)*this.nbinsx)/this.nbinsx/this.nbinsy+1,e.value=i.getBinContent(e.ix,e.iy,e.iz),e.error=i.getBinError(e.ix,e.iy,e.iz),e.lines=this.getBinTooltips(e.ix-1,e.iy-1,e.iz-1)}return e}createContour(t,i,e){if(!t||!i)return;e||(e={});let n=s.gStyle.fNumberContours,o=this.minbin,r=this.maxbin,h=this.minposbin;e.scatter_plot&&(n>50&&(n=50),o=this.minposbin),o===r&&(o=this.gminbin,r=this.gmaxbin,h=this.gminposbin),this.getDimension()<3&&(t.zoom_zmin!==t.zoom_zmax?(o=t.zoom_zmin,r=t.zoom_zmax):e.full_z_range&&(o=t.zmin,r=t.zmax)),i.setFullRange(t.zmin,t.zmax),i.createContour(t.logz,n,o,r,h),this.getDimension()<3&&(t.scale_zmin=i.colzmin,t.scale_zmax=i.colzmax)}changeValuesRange(t,i){const e=this.getFramePainter();if(!e)return;const n=e.isAxisZoomed(i)?"zoom_"+i:i,o="["+e[`${n}min`]+","+e[`${n}max`]+"]";t.input("Enter values range for axis "+i+" like [0,100] or empty string to unzoom",o).then((t=>{t=t?JSON.parse(t):[],(0,s.isObject)(t)&&2===t.length&&Number.isFinite(t[0])&&Number.isFinite(t[1])?e.zoom(i,t[0],t[1]):e.unzoom(i)}))}fillContextMenuItems(t){this.draw_content&&(t.addchk(this.toggleStat("only-check"),"Show statbox",(()=>this.toggleStat())),2===this.getDimension()&&t.add("Values range",(()=>this.changeValuesRange(t,"z"))),(0,s.isFunc)(this.fillHistContextMenu)&&this.fillHistContextMenu(t));const i=this.getFramePainter();if(this.options.Mode3D){t.size()>0&&t.add("separator");const e=this.getMainPainter()||this;t.addchk(e.isTooltipAllowed(),"Show tooltips",(()=>e.setTooltipAllowed("toggle"))),t.addchk(i?.enable_highlight,"Highlight bins",(()=>{i.enable_highlight=!i.enable_highlight,!i.enable_highlight&&e.mode3d&&(0,s.isFunc)(e.highlightBin3D)&&e.highlightBin3D(null)})),(0,s.isFunc)(i?.render3D)&&(t.addchk(e.options.FrontBox,"Front box",(()=>{e.options.FrontBox=!e.options.FrontBox,i.render3D()})),t.addchk(e.options.BackBox,"Back box",(()=>{e.options.BackBox=!e.options.BackBox,i.render3D()}))),this.draw_content&&(t.addchk(!this.options.Zero,"Suppress zeros",(()=>{this.options.Zero=!this.options.Zero,this.redrawPad()})),12!==this.options.Lego&&14!==this.options.Lego||this.fillPaletteMenu(t)),(0,s.isFunc)(e.control?.reset)&&t.add("Reset camera",(()=>e.control.reset()))}this.histogram_updated&&i.zoomChangedInteractive()&&t.add("Let update zoom",(()=>i.zoomChangedInteractive("reset")))}updatePaletteDraw(){this.isMainPainter()&&this.getPadPainter().findPainterFor(void 0,void 0,`${s.nsREX}RPaletteDrawable`)?.drawPalette()}fillPaletteMenu(t){t.addPaletteMenu(this.options.Palette||s.settings.Palette,(t=>{this.options.Palette=parseInt(t),this.redraw()}))}toggleMode3D(){return this.options.Mode3D=!this.options.Mode3D,this.options.Mode3D&&(this.options.Surf||this.options.Lego||this.options.Error||(this.nbinsx>=50||this.nbinsy>=50?this.options.Lego=this.options.Color?14:13:this.options.Lego=this.options.Color?12:1,this.options.Zero=!1)),this.copyOptionsToOthers(),this.interactiveRedraw("pad","drawopt")}prepareDraw(t){t||(t={rounding:!0,extra:0,middle:0}),void 0===t.extra&&(t.extra=0),void 0===t.right_extra&&(t.right_extra=t.extra),void 0===t.middle&&(t.middle=0);const i=this.getHisto(),e=this.getAxis("x"),s=this.getAxis("y"),n=this.getFramePainter(),o=this.getDimension(),r={i1:this.getSelectIndex("x","left",0-t.extra),i2:this.getSelectIndex("x","right",1+t.right_extra),j1:o<2?0:this.getSelectIndex("y","left",0-t.extra),j2:o<2?1:this.getSelectIndex("y","right",1+t.right_extra),k1:o<3?0:this.getSelectIndex("z","left",0-t.extra),k2:o<3?1:this.getSelectIndex("z","right",1+t.right_extra),stepi:1,stepj:1,stepk:1,min:0,max:0,sumz:0,xbar1:0,xbar2:1,ybar1:0,ybar2:1};let h,a,g,d,c,x;if(this.isDisplayItem()&&i.fIndicies&&(r.i1<i.fIndicies[0]&&(r.i1=i.fIndicies[0],r.incomplete=!0),r.i2>i.fIndicies[1]&&(r.i2=i.fIndicies[1],r.incomplete=!0),r.stepi=i.fIndicies[2],r.stepi>1&&(r.incomplete=!0),o>1&&i.fIndicies.length>5&&(r.j1<i.fIndicies[3]&&(r.j1=i.fIndicies[3],r.incomplete=!0),r.j2>i.fIndicies[4]&&(r.j2=i.fIndicies[4],r.incomplete=!0),r.stepj=i.fIndicies[5],r.stepj>1&&(r.incomplete=!0)),o>2&&i.fIndicies.length>8&&(r.k1<i.fIndicies[6]&&(r.k1=i.fIndicies[6],r.incomplete=!0),r.k2>i.fIndicies[7]&&(r.k2=i.fIndicies[7],r.incomplete=!0),r.stepk=i.fIndicies[8],r.stepk>1&&(r.incomplete=!0))),t.only_indexes)return r;r.grx=new Array(r.i2+r.stepi+1),r.gry=new Array(r.j2+r.stepj+1),t.original&&(r.original=!0,r.origx=new Array(r.i2+1),r.origy=new Array(r.j2+1)),t.pixel_density&&(t.rounding=!0);const f=n.getGrFuncs(this.options.second_x,this.options.second_y);for(h=r.i1;h<=r.i2;++h)g=e.GetBinCoord(h+t.middle),f.logx&&g<=0?r.i1=h+1:(r.origx&&(r.origx[h]=g),r.grx[h]=f.grx(g),t.rounding&&(r.grx[h]=Math.round(r.grx[h])),t.use3d&&(r.grx[h]<-n.size_x3d&&(r.i1=h,r.grx[h]=-n.size_x3d),r.grx[h]>n.size_x3d&&(r.i2=h,r.grx[h]=n.size_x3d)));for(t.use3d&&(r.i1<r.i2-2&&r.grx[r.i1]===r.grx[r.i1+1]&&r.i1++,r.i1<r.i2-2&&r.grx[r.i2-1]===r.grx[r.i2]&&r.i2--);h<r.i2+r.stepi+1;)r.grx[h++]=r.grx[r.i2];if(1===o)r.gry[0]=f.gry(0),r.gry[1]=f.gry(1);else for(a=r.j1;a<=r.j2;++a)d=s.GetBinCoord(a+t.middle),f.logy&&d<=0?r.j1=a+1:(r.origy&&(r.origy[a]=d),r.gry[a]=f.gry(d),t.rounding&&(r.gry[a]=Math.round(r.gry[a])),t.use3d&&(r.gry[a]<-n.size_y3d&&(r.j1=a,r.gry[a]=-n.size_y3d),r.gry[a]>n.size_y3d&&(r.j2=a,r.gry[a]=n.size_y3d)));if(t.use3d&&o>1&&(r.j1<r.j2-2&&r.gry[r.j1]===r.gry[r.j1+1]&&r.j1++,r.j1<r.j2-2&&r.gry[r.j2-1]===r.gry[r.j2]&&r.j2--),o>1)for(;a<r.j2+r.stepj+1;)r.gry[a++]=r.gry[r.j2];for(this.maxbin=this.minbin=this.minposbin=null,h=r.i1;h<r.i2;h+=r.stepi)for(a=r.j1;a<r.j2;a+=r.stepj)if(c=i.getBinContent(h+1,a+1),Number.isFinite(c)){if(r.sumz+=c,t.pixel_density){if(x=(r.grx[h+r.stepi]-r.grx[h])*(r.gry[a]-r.gry[a+r.stepj]),x<=0)continue;r.max=Math.max(r.max,c),c>0&&(c<r.min||0===r.min)&&(r.min=c),c/=x}null===this.maxbin?this.maxbin=this.minbin=c:(this.maxbin=Math.max(this.maxbin,c),this.minbin=Math.min(this.minbin,c)),c>0&&(null===this.minposbin||c<this.minposbin)&&(this.minposbin=c)}return r.palette=n.getHistPalette(),r.palette&&this.createContour(n,r.palette,t),r}}}}]);
//# sourceMappingURL=7663.b44e8d57.chunk.js.map