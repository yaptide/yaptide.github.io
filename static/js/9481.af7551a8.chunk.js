"use strict";(self.webpackChunkthreejs_editor_react=self.webpackChunkthreejs_editor_react||[]).push([[9481],{9481:(t,e,i)=>{i.r(e),i.d(e,{TGaxisPainter:()=>x});var s=i(9490),n=i(8260),a=i(1597),h=i(1488),r=i(4861),c=i(9726),f=i(3558),o=i(1227),g=i(4041);class x extends h.TB{convertTo(t){const e=this.getObject(),i=this.axisToSvg("x",e.fX1),s=this.axisToSvg("y",e.fY1),n=this.axisToSvg("x",e.fX2),a=this.axisToSvg("y",e.fY2);if("ndc"===t){const t=this.getPadPainter().getPadWidth(),h=this.getPadPainter().getPadHeight();e.fX1=i/t,e.fX2=n/t,e.fY1=(h-s)/h,e.fY2=(h-a)/h,this.use_ndc=!0}else if("frame"===t){const t=this.getFramePainter().getFrameRect();e.fX1=(i-t.x)/t.width,e.fX2=(n-t.x)/t.width,e.fY1=(s-t.y)/t.height,e.fY2=(a-t.y)/t.height,this.bind_frame=!0}}moveDrag(t,e){this.gaxis_x+=t,this.gaxis_y+=e,(0,a.bk)(this.getG(),this.gaxis_x,this.gaxis_y)}moveEnd(t){if(t)return;const e=this.getObject();let i,s;if(this.bind_frame){const t=this.getFramePainter().getFrameRect();i=(this.gaxis_x-t.x)/t.width,s=(this.gaxis_y-t.y)/t.height}else i=this.svgToAxis("x",this.gaxis_x,this.use_ndc),s=this.svgToAxis("y",this.gaxis_y,this.use_ndc);this.vertical?(e.fX1=e.fX2=i,this.reverse?(e.fY2=s+(e.fY2-e.fY1),e.fY1=s):(e.fY1=s+(e.fY1-e.fY2),e.fY2=s)):(this.reverse?(e.fX1=i+(e.fX1-e.fX2),e.fX2=i):(e.fX2=i+(e.fX2-e.fX1),e.fX1=i),e.fY1=e.fY2=s),this.submitAxisExec(`SetX1(${e.fX1});;SetX2(${e.fX2});;SetY1(${e.fY1});;SetY2(${e.fY2})`,!0)}redraw(){const t=this.getObject(),e=t.fWmin,i=t.fWmax;let s,n,h,r;if(this.bind_frame){const e=this.getFramePainter().getFrameRect();s=Math.round(e.x+t.fX1*e.width),h=Math.round(e.x+t.fX2*e.width),n=Math.round(e.y+t.fY1*e.height),r=Math.round(e.y+t.fY2*e.height)}else s=this.axisToSvg("x",t.fX1,this.use_ndc),n=this.axisToSvg("y",t.fY1,this.use_ndc),h=this.axisToSvg("x",t.fX2,this.use_ndc),r=this.axisToSvg("y",t.fY2,this.use_ndc);const o=h-s,g=n-r,x=Math.abs(o)<Math.abs(g);let _=x?g:o,u=!1;return _<0&&(u=!0,_=-_,x?r=n:s=h),this.configureAxis(x?"yaxis":"xaxis",e,i,e,i,x,[0,_],{time_scale:t.fChopt.indexOf("t")>=0,log:t.fChopt.indexOf("G")>=0?1:0,reverse:u,swap_side:u,axis_func:this.axis_func}),this.createG(),this.gaxis_x=s,this.gaxis_y=r,this.drawAxis(this.getG(),Math.abs(o),Math.abs(g),(0,a.bk)(this.gaxis_x,this.gaxis_y)||"").then((()=>((0,c.X2)(this),(0,f.wh)(this),this)))}fillContextMenu(t){t.addTAxisMenu(h.rb,this,this.getObject(),"")}async checkFuncion(){const t=this.getObject();if(!t.fFunctionName)return void(this.axis_func=null);const e=this.getPadPainter()?.findInPrimitives(t.fFunctionName,s.clTF1);let i=Promise.resolve(e);if(!e){const e=(0,o.gZ)(),n=e?.findItem({name:t.fFunctionName,check_keys:!0});n&&(i=e.getObject({item:n}).then((t=>t?.obj?._typename===s.clTF1?t.obj:null)))}return i.then((t=>{this.axis_func=t,t&&(0,g.Dx)(t)}))}createFuncHandle(t,e,i,s){const a=function(t){return a.toGraph(t)};a._func=t,a._domain=[i,s],a._scale=e?(0,n.ZE)().base(e):(0,n.m4)(),a._scale.domain(a._domain).range([0,100]),a.eval=function(t){try{t=a._func.evalPar(t)}catch(e){t=0}return Number.isFinite(t)?t:0};const h=a.eval(i),r=a.eval(s);return h<r===i<s?(a._vmin=h,a._vk=1/(r-h)):h===r?(a._vmin=0,a._vk=1):(a._vmin=r,a._vk=1/(h-r)),a._range=[0,100],a.range=function(t){return t?(a._range=t,a):a._range},a.domain=function(){return a._domain},a.toGraph=function(t){const e=(a.eval(t)-a._vmin)*a._vk;return a._range[0]*(1-e)+a._range[1]*e},a.ticks=function(t){return a._scale.ticks(t)},a}static async draw(t,e,i){const s=new x(t,e,!1);return(0,r.ensureTCanvas)(s,!1).then((()=>(i&&s.convertTo(i),s.checkFuncion()))).then((()=>s.redraw()))}}}}]);
//# sourceMappingURL=9481.af7551a8.chunk.js.map