"use strict";(self.webpackChunkthreejs_editor_react=self.webpackChunkthreejs_editor_react||[]).push([[1403],{1403:(t,s,i)=>{i.r(s),i.d(s,{drawBox:()=>x,drawEllipse:()=>f,drawJSImage:()=>y,drawMarker:()=>l,drawPie:()=>d,drawPolyLine:()=>c,drawPolyMarker:()=>g,drawText:()=>r});var h=i(9490),e=i(8260),a=i(1597),n=i(9726),o=i(3558);async function r(){const t=this.getObject(),s=this.getPadPainter(),i=s.getPadWidth(),e=s.getPadHeight(),r=this.getFramePainter();let c=t.fX,f=t.fY,d=1,x=this.matchObjectType(h.clTAnnotation);if(this.createAttText({attr:t}),x&&r?.mode3d&&(0,h.isFunc)(r?.convert3DtoPadNDC)){const s=r.convert3DtoPadNDC(t.fX,t.fY,t.fZ);c=s.x,f=s.y,this.isndc=!0,x="3d"}else t.TestBit((0,h.BIT)(14))?this.isndc=!0:s.getRootPad(!0)||(this.isndc=!0,c=f=.5,t.fTextAlign=22);this.createG(),this.draw_g.attr("transform",null),this.pos_x=this.axisToSvg("x",c,this.isndc),this.pos_y=this.axisToSvg("y",f,this.isndc);const l=this.textatt.createArg({x:this.pos_x,y:this.pos_y,text:t.fTitle,latex:0});return t._typename===h.clTLatex||x?(l.latex=1,d=.9):t._typename===h.clTMathText&&(l.latex=2,d=.8),this.startTextDrawing(this.textatt.font,this.textatt.getSize(i,e,d,.05)),this.drawText(l),this.finishTextDrawing().then((()=>(this.isBatchMode()||(this.pos_dx=this.pos_dy=0,this.moveDrag||(this.moveDrag=function(t,s){this.pos_dx+=t,this.pos_dy+=s,(0,a.bk)(this.draw_g,this.pos_dx,this.pos_dy)}),this.moveEnd||(this.moveEnd=function(t){if(t)return;const s=this.getObject();s.fX=this.svgToAxis("x",this.pos_x+this.pos_dx,this.isndc),s.fY=this.svgToAxis("y",this.pos_y+this.pos_dy,this.isndc),this.submitCanvExec(`SetX(${s.fX});;SetY(${s.fY});;`)}),"3d"!==x?(0,n.X2)(this):(r.processRender3D=!0,this.handleRender3D=()=>{const s=r.convert3DtoPadNDC(t.fX,t.fY,t.fZ),i=this.axisToSvg("x",s.x,!0),h=this.axisToSvg("y",s.y,!0);(0,a.bk)(this.draw_g,i-this.pos_x,h-this.pos_y)}),(0,o.wh)(this,o.Ew)),this)))}function c(){this.createG();const t=this.getObject(),s=(0,h.BIT)(14),i=t.TestBit(s),e=this.getDrawOpt()||t.fOption,r=t._typename===h.clTPolyLine&&("f"===e||"F"===e),c=this.getAxisToSvgFunc(i);this.createAttLine({attr:t}),this.createAttFill({attr:t});let f="";for(let h=0;h<=t.fLastPoint;++h)f+=`${h>0?"L":"M"}${c.x(t.fX[h])},${c.y(t.fY[h])}`;r&&(f+="Z");const d=this.draw_g.append("svg:path").attr("d",f);r?d.call(this.fillatt.func):d.call(this.lineatt.func).style("fill","none"),(0,o.wh)(this,o.Ew),(0,n.X2)(this),this.dx=this.dy=0,this.isndc=i,this.moveDrag=function(t,s){this.dx+=t,this.dy+=s,(0,a.bk)(this.draw_g.select("path"),this.dx,this.dy)},this.moveEnd=function(t){if(t)return;const s=this.getObject(),i=this.getAxisToSvgFunc(this.isndc);let h="";for(let e=0;e<=s.fLastPoint;++e){const t=this.svgToAxis("x",i.x(s.fX[e])+this.dx,this.isndc),a=this.svgToAxis("y",i.y(s.fY[e])+this.dy,this.isndc);s.fX[e]=t,s.fY[e]=a,h+=`SetPoint(${e},${t},${a});;`}this.submitCanvExec(h+"Notify();;"),this.redraw()}}function f(){const t=this.getObject(),s=0===t.fPhimin&&360===t.fPhimax,i="TCrown"===t._typename;this.createAttLine({attr:t}),this.createAttFill({attr:t}),this.createG();const h=this.getAxisToSvgFunc(),e=h.x(t.fX1),r=h.y(t.fY1),c=i&&t.fR1<=0?h.x(t.fX1+t.fR2)-e:h.x(t.fX1+t.fR1)-e,f=r-h.y(t.fY1+t.fR2);let d="";if(i&&t.fR1>0){const i=c,a=f,n=r-h.y(t.fY1+t.fR1),o=h.x(t.fX1+t.fR2)-e;if(s)d=`M${-i},0A${i},${n},0,1,0,${i},0A${i},${n},0,1,0,${-i},0M${-o},0A${o},${a},0,1,0,${o},0A${o},${a},0,1,0,${-o},0`;else{const s=t.fPhimax-t.fPhimin>=180?1:0,h=t.fPhimin*Math.PI/180,e=t.fPhimax*Math.PI/180,r=Math.round(i*Math.cos(h)),c=Math.round(n*Math.sin(h));d=`M${Math.round(i*Math.cos(e))},${Math.round(n*Math.sin(e))}A${i},${n},0,${s},0,${r},${c}L${Math.round(o*Math.cos(h))},${Math.round(a*Math.sin(h))}A${o},${a},0,${s},1,${Math.round(o*Math.cos(e))},${Math.round(a*Math.sin(e))}Z`}}else if(0===t.fTheta)if(s)d=`M${-c},0A${c},${f},0,1,0,${c},0A${c},${f},0,1,0,${-c},0Z`;else{d=`M0,0L${Math.round(c*Math.cos(t.fPhimin*Math.PI/180))},${Math.round(f*Math.sin(t.fPhimin*Math.PI/180))}A${c},${f},0,1,1,${Math.round(c*Math.cos(t.fPhimax*Math.PI/180))},${Math.round(f*Math.sin(t.fPhimax*Math.PI/180))}Z`}else{const i=Math.cos(t.fTheta*Math.PI/180),a=Math.sin(t.fTheta*Math.PI/180),n=t.fPhimin*Math.PI/180,o=200,c=(t.fPhimax*Math.PI/180-n)/(o-(s?0:1));let f=0,x=0;s||(d="M0,0");for(let s=0;s<o;++s){const o=n+s*c,l=t.fR1*Math.cos(o),g=t.fR2*Math.sin(o),y=h.x(t.fX1+l*i-g*a)-e,$=h.y(t.fY1+l*a+g*i)-r;d?d+=f===y?"v"+($-x):x===$?"h"+(y-f):`l${y-f},${$-x}`:d=`M${y},${$}`,f=y,x=$}d+="Z"}this.x=e,this.y=r,(0,a.bk)(this.draw_g.append("svg:path"),e,r).attr("d",d).call(this.lineatt.func).call(this.fillatt.func),(0,o.wh)(this,o.Ew),(0,n.X2)(this),this.moveDrag=function(t,s){this.x+=t,this.y+=s,(0,a.bk)(this.draw_g.select("path"),this.x,this.y)},this.moveEnd=function(t){if(t)return;const s=this.getObject();s.fX1=this.svgToAxis("x",this.x),s.fY1=this.svgToAxis("y",this.y),this.submitCanvExec(`SetX1(${s.fX1});;SetY1(${s.fY1});;Notify();;`)}}function d(){this.createG();const t=this.getObject(),s=t.fPieSlices.length,i=this.axisToSvg("x",t.fX),h=this.axisToSvg("y",t.fY),e=this.axisToSvg("x",t.fX+t.fRadius)-i,n=this.axisToSvg("y",t.fY+t.fRadius)-h;(0,a.bk)(this.draw_g,i,h);let o=0,r=t.fAngularOffset*Math.PI/180,c=Math.round(e*Math.cos(r)),f=Math.round(n*Math.sin(r));for(let a=0;a<s;a++)o+=t.fPieSlices[a].fValue;for(let a=0;a<s;a++){const s=t.fPieSlices[a];this.createAttLine({attr:s}),this.createAttFill({attr:s}),r+=s.fValue/o*2*Math.PI;const i=Math.round(e*Math.cos(r)),h=Math.round(n*Math.sin(r));this.draw_g.append("svg:path").attr("d",`M0,0L${c},${f}A${e},${n},0,0,0,${i},${h}z`).call(this.lineatt.func).call(this.fillatt.func),c=i,f=h}}function x(){const t=this.getObject(),s=this.getDrawOpt().toUpperCase().indexOf("L")>=0;this.createAttLine({attr:t}),this.createAttFill({attr:t}),this.fillatt.empty()||s||(this.lineatt.color="none"),this.createG(),this.x1=this.axisToSvg("x",t.fX1),this.x2=this.axisToSvg("x",t.fX2),this.y1=this.axisToSvg("y",t.fY1),this.y2=this.axisToSvg("y",t.fY2),this.borderMode=t.fBorderMode&&t.fBorderSize&&this.fillatt.hasColor()?t.fBorderMode:0,this.borderSize=t.fBorderSize,this.getPathes=()=>{const t=Math.min(this.x1,this.x2),s=Math.min(this.y1,this.y2),i=Math.abs(this.x2-this.x1),h=Math.abs(this.y1-this.y2),e=`M${t},${s}h${i}v${h}h${-i}z`;if(!this.borderMode)return[e];const a=this.borderSize,n=this.borderSize,o=`M${t},${s}h${i}l${-a},${n}h${2*a-i}v${h-2*n}l${-a},${n}z`,r=`M${t+i},${s+h}v${-h}l${-a},${n}v${h-2*n}h${2*a-i}l${-a},${n}z`;return this.borderMode>0?[e,o,r]:[e,r,o]};const i=this.getPathes();this.draw_g.append("svg:path").attr("d",i[0]).call(this.lineatt.func).call(this.fillatt.func),this.borderMode&&(this.draw_g.append("svg:path").attr("d",i[1]).call(this.fillatt.func).style("fill",(0,e.Qh)(this.fillatt.color).brighter(.5).formatHex()),this.draw_g.append("svg:path").attr("d",i[2]).call(this.fillatt.func).style("fill",(0,e.Qh)(this.fillatt.color).darker(.5).formatHex())),(0,o.wh)(this,o.Ew),(0,n.X2)(this),this.moveStart=function(t,s){const i=Math.abs(this.x2-this.x1),h=Math.abs(this.y1-this.y2);this.c_x1=Math.abs(t-this.x2)>.1*i,this.c_x2=Math.abs(t-this.x1)>.1*i,this.c_y1=Math.abs(s-this.y2)>.1*h,this.c_y2=Math.abs(s-this.y1)>.1*h,this.c_x1!==this.c_x2&&this.c_y1&&this.c_y2&&(this.c_y1=this.c_y2=!1),this.c_y1!==this.c_y2&&this.c_x1&&this.c_x2&&(this.c_x1=this.c_x2=!1)},this.moveDrag=function(t,s){this.c_x1&&(this.x1+=t),this.c_x2&&(this.x2+=t),this.c_y1&&(this.y1+=s),this.c_y2&&(this.y2+=s);const i=this.draw_g.selectAll("path").nodes();this.getPathes().forEach(((t,s)=>(0,e.Lt)(i[s]).attr("d",t)))},this.moveEnd=function(t){if(t)return;const s=this.getObject();let i="";this.c_x1&&(s.fX1=this.svgToAxis("x",this.x1),i+=`SetX1(${s.fX1});;`),this.c_x2&&(s.fX2=this.svgToAxis("x",this.x2),i+=`SetX2(${s.fX2});;`),this.c_y1&&(s.fY1=this.svgToAxis("y",this.y1),i+=`SetY1(${s.fY1});;`),this.c_y2&&(s.fY2=this.svgToAxis("y",this.y2),i+=`SetY2(${s.fY2});;`),this.submitCanvExec(i+"Notify();;")}}function l(){const t=this.getObject(),s=(0,h.BIT)(14);this.isndc=t.TestBit(s),this.createAttMarker({attr:t}),this.createG();const i=this.axisToSvg("x",t.fX,this.isndc),e=this.axisToSvg("y",t.fY,this.isndc),r=this.markeratt.create(i,e);r&&this.draw_g.append("svg:path").attr("d",r).call(this.markeratt.func),(0,o.wh)(this,o.Ew),(0,n.X2)(this),this.dx=this.dy=0,this.moveDrag=function(t,s){this.dx+=t,this.dy+=s,(0,a.bk)(this.draw_g.select("path"),this.dx,this.dy)},this.moveEnd=function(t){if(t)return;const s=this.getObject();s.fX=this.svgToAxis("x",this.axisToSvg("x",s.fX,this.isndc)+this.dx,this.isndc),s.fY=this.svgToAxis("y",this.axisToSvg("y",s.fY,this.isndc)+this.dy,this.isndc),this.submitCanvExec(`SetX(${s.fX});;SetY(${s.fY});;Notify();;`),this.redraw()}}function g(){const t=this.getObject(),s=this.getAxisToSvgFunc();this.createAttMarker({attr:t}),this.createG();let i="";for(let h=0;h<=t.fLastPoint;++h)i+=this.markeratt.create(s.x(t.fX[h]),s.y(t.fY[h]));i&&this.draw_g.append("svg:path").attr("d",i).call(this.markeratt.func),(0,o.wh)(this,o.Ew),(0,n.X2)(this),this.dx=this.dy=0,this.moveDrag=function(t,s){this.dx+=t,this.dy+=s,(0,a.bk)(this.draw_g.select("path"),this.dx,this.dy)},this.moveEnd=function(t){if(t)return;const s=this.getObject(),i=this.getAxisToSvgFunc();let h="";for(let e=0;e<=s.fLastPoint;++e){const t=this.svgToAxis("x",i.x(s.fX[e])+this.dx),a=this.svgToAxis("y",i.y(s.fY[e])+this.dy);s.fX[e]=t,s.fY[e]=a,h+=`SetPoint(${e},${t},${a});;`}this.submitCanvExec(h+"Notify();;"),this.redraw()}}function y(t,s,i){const h=new a.b8(t),e=h.selectDom(),n=e.append("img").attr("src",s.fName).attr("title",s.fTitle||s.fName);return i&&i.indexOf("scale")>=0?n.style("width","100%").style("height","100%"):i&&i.indexOf("center")>=0&&(e.style("position","relative"),n.attr("style","margin: 0; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);")),h.setTopPainter(),h}}}]);
//# sourceMappingURL=1403.15ce6bce.chunk.js.map